language: scala
jdk: oraclejdk8

env:
  global:
    - SBT_GHPAGES_COMMIT_MESSAGE='Publishing Scaladoc [ci skip]'
    - SBT_OPTS="-XX:+UseConcMarkSweepGC -XX:+CMSClassUnloadingEnabled -XX:MetaspaceSize=256M -XX:MaxMetaspaceSize=512M -Xmx2G"

script: sbt clean coverage +test

deploy:
  provider: script
  script: bash deploy.sh
  on:
    branch: master

cache:
  directories:
  - $HOME/.sbt
  - $HOME/.ivy2
  - $HOME/.m2

before_cache:
  # Cleanup the cached directories to avoid unnecessary cache updates
  - find $HOME/.ivy2/cache    -name "ivydata-*.properties"      -print -delete
  - find $HOME/.sbt           -name "*.lock"                    -print -delete
  - find $HOME/.sbt/ghpages   -type d                           -print -delete
